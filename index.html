<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¨Ø« Ù…Ø¨Ø§Ø´Ø± - Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª | Streaming Live Sports</title>
    <style>
        :root {
            --color-white: rgba(255, 255, 255, 1);
            --color-black: rgba(0, 0, 0, 1);
            --color-cream-50: rgba(252, 252, 249, 1);
            --color-cream-100: rgba(255, 255, 253, 1);
            --color-gray-200: rgba(245, 245, 245, 1);
            --color-gray-300: rgba(167, 169, 169, 1);
            --color-gray-400: rgba(119, 124, 124, 1);
            --color-slate-500: rgba(98, 108, 113, 1);
            --color-brown-600: rgba(94, 82, 64, 1);
            --color-charcoal-700: rgba(31, 33, 33, 1);
            --color-charcoal-800: rgba(38, 40, 40, 1);
            --color-slate-900: rgba(19, 52, 59, 1);
            --color-teal-300: rgba(50, 184, 198, 1);
            --color-teal-400: rgba(45, 166, 178, 1);
            --color-teal-500: rgba(33, 128, 141, 1);
            --color-teal-600: rgba(29, 116, 128, 1);
            --color-teal-700: rgba(26, 104, 115, 1);
            --color-red-400: rgba(255, 84, 89, 1);
            --color-red-500: rgba(192, 21, 47, 1);
            --color-orange-400: rgba(230, 129, 97, 1);
            --color-orange-500: rgba(168, 75, 47, 1);
            
            --color-brown-600-rgb: 94, 82, 64;
            --color-teal-500-rgb: 33, 128, 141;
            --color-slate-900-rgb: 19, 52, 59;
            --color-slate-500-rgb: 98, 108, 113;
            --color-red-500-rgb: 192, 21, 47;
            
            --color-background: var(--color-cream-50);
            --color-surface: var(--color-cream-100);
            --color-text: var(--color-slate-900);
            --color-text-secondary: var(--color-slate-500);
            --color-primary: var(--color-teal-500);
            --color-primary-hover: var(--color-teal-600);
            --color-primary-active: var(--color-teal-700);
            --color-secondary: rgba(var(--color-brown-600-rgb), 0.12);
            --color-secondary-hover: rgba(var(--color-brown-600-rgb), 0.2);
            --color-border: rgba(var(--color-brown-600-rgb), 0.2);
            --color-card-border: rgba(var(--color-brown-600-rgb), 0.12);
            --color-error: var(--color-red-500);
            --color-success: var(--color-teal-500);
            --color-warning: var(--color-orange-500);
            
            --font-family-base: 'Segoe UI', Tahoma, Arial, sans-serif;
            --font-size-xs: 11px;
            --font-size-sm: 12px;
            --font-size-base: 14px;
            --font-size-md: 14px;
            --font-size-lg: 16px;
            --font-size-xl: 18px;
            --font-size-2xl: 20px;
            --font-size-3xl: 24px;
            --font-size-4xl: 30px;
            --font-weight-normal: 400;
            --font-weight-medium: 500;
            --font-weight-semibold: 550;
            --font-weight-bold: 600;
            
            --space-4: 4px;
            --space-8: 8px;
            --space-12: 12px;
            --space-16: 16px;
            --space-20: 20px;
            --space-24: 24px;
            --space-32: 32px;
            
            --radius-sm: 6px;
            --radius-base: 8px;
            --radius-md: 10px;
            --radius-lg: 12px;
            --radius-full: 9999px;
            
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.02);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.04), 0 2px 4px -1px rgba(0, 0, 0, 0.02);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --color-gray-400-rgb: 119, 124, 124;
                --color-teal-300-rgb: 50, 184, 198;
                --color-gray-300-rgb: 167, 169, 169;
                --color-gray-200-rgb: 245, 245, 245;
                
                --color-background: var(--color-charcoal-700);
                --color-surface: var(--color-charcoal-800);
                --color-text: var(--color-gray-200);
                --color-text-secondary: rgba(var(--color-gray-300-rgb), 0.7);
                --color-primary: var(--color-teal-300);
                --color-primary-hover: var(--color-teal-400);
                --color-secondary: rgba(var(--color-gray-400-rgb), 0.15);
                --color-secondary-hover: rgba(var(--color-gray-400-rgb), 0.25);
                --color-border: rgba(var(--color-gray-400-rgb), 0.3);
                --color-card-border: rgba(var(--color-gray-400-rgb), 0.2);
                --color-error: var(--color-red-400);
                --color-success: var(--color-teal-300);
                --color-warning: var(--color-orange-400);
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-family-base);
            background-color: var(--color-background);
            color: var(--color-text);
            line-height: 1.6;
            min-height: 100vh;
        }

        .header {
            background: var(--color-surface);
            border-bottom: 1px solid var(--color-border);
            padding: var(--space-16) var(--space-24);
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow-sm);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: var(--font-size-3xl);
            font-weight: var(--font-weight-bold);
            color: var(--color-primary);
            display: flex;
            align-items: center;
            gap: var(--space-8);
        }

        .nav-tabs {
            display: flex;
            gap: var(--space-8);
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: var(--space-8) var(--space-16);
            background: transparent;
            border: 1px solid var(--color-border);
            border-radius: var(--radius-base);
            color: var(--color-text);
            cursor: pointer;
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-medium);
            transition: all 0.2s;
        }

        .tab-btn:hover {
            background: var(--color-secondary);
        }

        .tab-btn.active {
            background: var(--color-primary);
            color: var(--color-white);
            border-color: var(--color-primary);
        }

        .league-section {
            margin-bottom: var(--space-32);
        }

        .league-header {
            display: flex;
            align-items: center;
            gap: var(--space-12);
            margin-bottom: var(--space-20);
            padding: var(--space-16);
            background: var(--color-surface);
            border-radius: var(--radius-lg);
            border: 1px solid var(--color-card-border);
        }

        .league-icon {
            font-size: var(--font-size-3xl);
        }

        .league-name {
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-bold);
            color: var(--color-text);
        }

        .league-count {
            background: var(--color-secondary);
            padding: var(--space-4) var(--space-12);
            border-radius: var(--radius-full);
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
            font-weight: var(--font-weight-medium);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: var(--space-24);
        }

        .section-title {
            font-size: var(--font-size-2xl);
            font-weight: var(--font-weight-bold);
            margin-bottom: var(--space-20);
            color: var(--color-text);
            display: flex;
            align-items: center;
            gap: var(--space-8);
        }

        .live-badge {
            display: inline-flex;
            align-items: center;
            gap: var(--space-4);
            background: var(--color-error);
            color: var(--color-white);
            padding: var(--space-4) var(--space-12);
            border-radius: var(--radius-sm);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-bold);
        }

        .live-dot {
            width: 8px;
            height: 8px;
            background: var(--color-white);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .matches-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: var(--space-20);
        }

        .match-card {
            background: var(--color-surface);
            border: 1px solid var(--color-card-border);
            border-radius: var(--radius-lg);
            padding: var(--space-20);
            transition: all 0.3s;
            cursor: pointer;
            box-shadow: var(--shadow-sm);
        }

        .match-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
            border-color: var(--color-primary);
        }

        .match-league {
            color: var(--color-text-secondary);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
            margin-bottom: var(--space-12);
            display: flex;
            align-items: center;
            gap: var(--space-8);
        }

        .match-time {
            background: var(--color-secondary);
            padding: var(--space-4) var(--space-8);
            border-radius: var(--radius-sm);
            font-size: var(--font-size-xs);
            color: var(--color-text-secondary);
        }

        .match-teams {
            display: flex;
            flex-direction: column;
            gap: var(--space-12);
            margin-bottom: var(--space-16);
        }

        .team {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: var(--space-12);
        }

        .team-name {
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-semibold);
            color: var(--color-text);
            flex: 1;
        }

        .team-score {
            font-size: var(--font-size-3xl);
            font-weight: var(--font-weight-bold);
            color: var(--color-primary);
            min-width: 40px;
            text-align: center;
        }

        .match-status {
            text-align: center;
            padding: var(--space-8) 0;
            margin: var(--space-12) 0;
            border-top: 1px solid var(--color-border);
            border-bottom: 1px solid var(--color-border);
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
            font-weight: var(--font-weight-medium);
        }

        .match-actions {
            display: flex;
            gap: var(--space-8);
        }

        .btn {
            flex: 1;
            padding: var(--space-8) var(--space-16);
            border: none;
            border-radius: var(--radius-base);
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-medium);
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .btn-primary {
            background: var(--color-primary);
            color: var(--color-white);
        }

        .btn-primary:hover {
            background: var(--color-primary-hover);
        }

        .btn-secondary {
            background: var(--color-secondary);
            color: var(--color-text);
        }

        .btn-secondary:hover {
            background: var(--color-secondary-hover);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: var(--space-20);
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--color-surface);
            border-radius: var(--radius-lg);
            width: 100%;
            max-width: 900px;
            max-height: 90vh;
            overflow: hidden;
            position: relative;
        }

        .modal-header {
            padding: var(--space-20);
            border-bottom: 1px solid var(--color-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-bold);
            color: var(--color-text);
        }

        .close-btn {
            background: var(--color-secondary);
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-size-xl);
            color: var(--color-text);
            transition: all 0.2s;
        }

        .close-btn:hover {
            background: var(--color-secondary-hover);
        }

        .modal-body {
            padding: var(--space-20);
        }

        .stream-container {
            background: var(--color-black);
            border-radius: var(--radius-md);
            aspect-ratio: 16/9;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--color-white);
            font-size: var(--font-size-lg);
            margin-bottom: var(--space-20);
        }

        iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: var(--radius-md);
        }

        .stream-options {
            display: flex;
            gap: var(--space-8);
            flex-wrap: wrap;
        }

        .stream-btn {
            padding: var(--space-8) var(--space-16);
            background: var(--color-secondary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-base);
            color: var(--color-text);
            cursor: pointer;
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-medium);
            transition: all 0.2s;
        }

        .stream-btn:hover {
            background: var(--color-secondary-hover);
        }

        .stream-btn.active {
            background: var(--color-primary);
            color: var(--color-white);
            border-color: var(--color-primary);
        }

        .empty-state {
            text-align: center;
            padding: var(--space-32);
            color: var(--color-text-secondary);
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: var(--space-16);
            opacity: 0.3;
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: var(--space-16);
            }

            .nav-tabs {
                width: 100%;
                justify-content: center;
            }

            .matches-grid {
                grid-template-columns: 1fr;
            }

            .modal-content {
                max-width: 100%;
                margin: var(--space-16);
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <span>âš½</span>
                <span id="siteName">Ø¨Ø« Ù…Ø¨Ø§Ø´Ø±</span>
            </div>
            <div style="display: flex; gap: var(--space-16); align-items: center; flex-wrap: wrap;">
                <nav class="nav-tabs">
                    <button class="tab-btn active" data-sport="all" id="tab-all">Ø§Ù„ÙƒÙ„</button>
                    <button class="tab-btn" data-sport="football" id="tab-football">ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù…</button>
                    <button class="tab-btn" data-sport="basketball" id="tab-basketball">ÙƒØ±Ø© Ø§Ù„Ø³Ù„Ø©</button>
                    <button class="tab-btn" data-sport="tennis" id="tab-tennis">Ø§Ù„ØªÙ†Ø³</button>
                </nav>
                <button class="btn-secondary" onclick="toggleLanguage()" style="padding: var(--space-8) var(--space-16); border-radius: var(--radius-base); border: 1px solid var(--color-border); cursor: pointer; font-size: var(--font-size-base); font-weight: var(--font-weight-medium);">
                    <span id="langIcon">ğŸ‡«ğŸ‡· FR</span>
                </button>
            </div>
        </div>
    </header>

    <main class="container">
        <h2 class="section-title">
            <span class="live-badge">
                <span class="live-dot"></span>
                <span id="liveTitle">Ù…Ø¨Ø§Ø´Ø± Ø§Ù„Ø¢Ù†</span>
            </span>
        </h2>
        <div id="liveMatches"></div>

        <h2 class="section-title" style="margin-top: var(--space-32)" id="upcomingTitle">Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©</h2>
        <div id="upcomingMatches"></div>

        <h2 class="section-title" style="margin-top: var(--space-32)" id="resultsTitle">Ø§Ù„Ù†ØªØ§Ø¦Ø¬</h2>
        <div id="resultsMatches"></div>
    </main>

    <div id="streamModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="modalTitle"></div>
                <button class="close-btn" onclick="closeModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="stream-container" id="streamContainer">
                    <div id="streamPlaceholder">Ø§Ø®ØªØ± Ù…ØµØ¯Ø± Ø§Ù„Ø¨Ø«</div>
                </div>
                <div class="stream-options" id="streamOptions"></div>
            </div>
        </div>
    </div>

    <script>
        const translations = {
            ar: {
                siteName: 'Ø¨Ø« Ù…Ø¨Ø§Ø´Ø±',
                liveNow: 'Ù…Ø¨Ø§Ø´Ø± Ø§Ù„Ø¢Ù†',
                upcoming: 'Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©',
                results: 'Ø§Ù„Ù†ØªØ§Ø¦Ø¬',
                all: 'Ø§Ù„ÙƒÙ„',
                football: 'ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù…',
                basketball: 'ÙƒØ±Ø© Ø§Ù„Ø³Ù„Ø©',
                tennis: 'Ø§Ù„ØªÙ†Ø³',
                matches: 'Ù…Ø¨Ø§Ø±ÙŠØ§Øª',
                premierLeague: 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ Ø§Ù„Ù…Ù…ØªØ§Ø²',
                laLiga: 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥Ø³Ø¨Ø§Ù†ÙŠ',
                serieA: 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥ÙŠØ·Ø§Ù„ÙŠ',
                bundesliga: 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø£Ù„Ù…Ø§Ù†ÙŠ',
                ligue1: 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„ÙØ±Ù†Ø³ÙŠ',
                championsLeague: 'Ø¯ÙˆØ±ÙŠ Ø£Ø¨Ø·Ø§Ù„ Ø£ÙˆØ±ÙˆØ¨Ø§',
                europaLeague: 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø£ÙˆØ±ÙˆØ¨ÙŠ',
                worldCup: 'ÙƒØ£Ø³ Ø§Ù„Ø¹Ø§Ù„Ù…',
                arabLeagues: 'Ø§Ù„Ø¯ÙˆØ±ÙŠØ§Øª Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©',
                otherLeagues: 'Ø¯ÙˆØ±ÙŠØ§Øª Ø£Ø®Ø±Ù‰',
                watchLive: 'ğŸ”´ Ø´Ø§Ù‡Ø¯ Ù…Ø¨Ø§Ø´Ø±',
                preview: 'ğŸ“º Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¨Ø«',
                noMatches: 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ù…ØªØ§Ø­Ø©',
                selectStream: 'Ø§Ø®ØªØ± Ù…ØµØ¯Ø± Ø§Ù„Ø¨Ø«',
                stream: 'Ø¨Ø«',
                hdStream: 'Ø¨Ø« HD',
                altStream: 'Ø¨Ø« Ø¨Ø¯ÙŠÙ„',
                hqStream: 'Ø¨Ø« Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ©',
                vs: 'Ø¶Ø¯',
                finished: 'Ø§Ù†ØªÙ‡Øª',
                notStarted: 'Ù„Ù… ØªØ¨Ø¯Ø£ Ø¨Ø¹Ø¯',
                soon: 'Ù‚Ø±ÙŠØ¨Ø§Ù‹',
                liveNowStatus: 'Ù…Ø¨Ø§Ø´Ø± Ø§Ù„Ø¢Ù†',
                firstHalf: 'Ø§Ù„Ø´ÙˆØ· Ø§Ù„Ø£ÙˆÙ„',
                secondHalf: 'Ø§Ù„Ø´ÙˆØ· Ø§Ù„Ø«Ø§Ù†ÙŠ',
                note: 'âš ï¸ Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„Ø±ÙˆØ§Ø¨Ø· ØªÙˆØ¶ÙŠØ­ÙŠØ©. Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¨Ø« Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©ØŒ ÙŠØ¬Ø¨ Ø§Ù„ØªÙƒØ§Ù…Ù„ Ù…Ø¹ Camel Live API'
            },
            fr: {
                siteName: 'Streaming en Direct',
                liveNow: 'En Direct',
                upcoming: 'Matchs Ã  Venir',
                results: 'RÃ©sultats',
                all: 'Tous',
                football: 'Football',
                basketball: 'Basketball',
                tennis: 'Tennis',
                matches: 'Matchs',
                premierLeague: 'Premier League Anglaise',
                laLiga: 'La Liga Espagnole',
                serieA: 'Serie A Italienne',
                bundesliga: 'Bundesliga Allemande',
                ligue1: 'Ligue 1 FranÃ§aise',
                championsLeague: 'Ligue des Champions',
                europaLeague: 'Ligue Europa',
                worldCup: 'Coupe du Monde',
                arabLeagues: 'Ligues Arabes',
                otherLeagues: 'Autres Ligues',
                watchLive: 'ğŸ”´ Regarder en Direct',
                preview: 'ğŸ“º AperÃ§u du Stream',
                noMatches: 'Aucun match disponible',
                selectStream: 'Choisir une source de stream',
                stream: 'Stream',
                hdStream: 'Stream HD',
                altStream: 'Stream Alternatif',
                hqStream: 'Stream Haute QualitÃ©',
                vs: 'vs',
                finished: 'TerminÃ©',
                notStarted: 'Pas encore commencÃ©',
                soon: 'BientÃ´t',
                liveNowStatus: 'En Direct',
                firstHalf: 'PremiÃ¨re Mi-Temps',
                secondHalf: 'DeuxiÃ¨me Mi-Temps',
                note: 'âš ï¸ Note: Liens de dÃ©monstration. Pour obtenir de vrais liens de streaming, vous devez intÃ©grer l\'API Camel Live'
            }
        };

        let currentLang = localStorage.getItem('language') || 'ar';

        function toggleLanguage() {
            currentLang = currentLang === 'ar' ? 'fr' : 'ar';
            localStorage.setItem('language', currentLang);
            document.documentElement.setAttribute('lang', currentLang);
            document.documentElement.setAttribute('dir', currentLang === 'ar' ? 'rtl' : 'ltr');
            updateUILanguage();
            renderMatches();
        }

        function updateUILanguage() {
            const t = translations[currentLang];
            document.getElementById('siteName').textContent = t.siteName;
            document.getElementById('liveTitle').textContent = t.liveNow;
            document.getElementById('upcomingTitle').textContent = t.upcoming;
            document.getElementById('resultsTitle').textContent = t.results;
            document.getElementById('tab-all').textContent = t.all;
            document.getElementById('tab-football').textContent = t.football;
            document.getElementById('tab-basketball').textContent = t.basketball;
            document.getElementById('tab-tennis').textContent = t.tennis;
            document.getElementById('langIcon').textContent = currentLang === 'ar' ? 'ğŸ‡«ğŸ‡· FR' : 'ğŸ‡¸ğŸ‡¦ AR';
            const placeholder = document.getElementById('streamPlaceholder');
            if (placeholder) placeholder.textContent = t.selectStream;
        }

        function getTranslation(key) {
            return translations[currentLang][key] || key;
        }

        const API_CONFIG = {
            camelLiveUrl: 'https://www.camel1.live/',
            updateInterval: 120000,
            timeout: 20000,
            retryAttempts: 3,
            corsProxies: [
                'https://api.allorigins.win/raw?url=',
                'https://corsproxy.io/?',
                'https://api.codetabs.com/v1/proxy?quest=',
                'https://thingproxy.freeboard.io/fetch/'
            ]
        };

        let matchesData = { live: [], upcoming: [], results: [] };
        let isLoading = false;
        let lastFetchTime = null;
        let currentProxyIndex = 0;
        let currentSport = 'all';

        function renderMatches() {
            renderMatchSection('liveMatches', matchesData.live, true);
            renderMatchSection('upcomingMatches', matchesData.upcoming, false);
            renderMatchSection('resultsMatches', matchesData.results, false, true);
        }

        function renderMatchSection(containerId, matches, isLive, isResult = false) {
            const container = document.getElementById(containerId);
            const filteredMatches = currentSport === 'all' ? matches : matches.filter(m => m.sport === currentSport);

            if (filteredMatches.length === 0) {
                container.innerHTML = `<div class="empty-state"><div class="empty-state-icon">âš½</div><div>${getTranslation('noMatches')}</div></div>`;
                return;
            }

            const matchesByLeague = groupMatchesByLeague(filteredMatches);
            container.innerHTML = Object.entries(matchesByLeague).map(([league, leagueMatches]) => `
                <div class="league-section">
                    <div class="league-header">
                        <span class="league-icon">${getLeagueIcon(league)}</span>
                        <span class="league-name">${currentLang === 'fr' ? getLeagueFrenchName(league) : league}</span>
                        <span class="league-count">${leagueMatches.length} ${getTranslation('matches')}</span>
                    </div>
                    <div class="matches-grid">
                        ${leagueMatches.map(match => renderMatchCard(match, isLive, isResult)).join('')}
                    </div>
                </div>
            `).join('');
        }

        function groupMatchesByLeague(matches) {
            const grouped = {};
            matches.forEach(match => {
                const league = match.league || getTranslation('otherLeagues');
                if (!grouped[league]) grouped[league] = [];
                grouped[league].push(match);
            });
            return grouped;
        }

        function getLeagueIcon(league) {
            const icons = {
                'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ Ø§Ù„Ù…Ù…ØªØ§Ø²': 'ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿', 'Premier League': 'ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿',
                'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥Ø³Ø¨Ø§Ù†ÙŠ': 'ğŸ‡ªğŸ‡¸', 'La Liga': 'ğŸ‡ªğŸ‡¸',
                'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥ÙŠØ·Ø§Ù„ÙŠ': 'ğŸ‡®ğŸ‡¹', 'Serie A': 'ğŸ‡®ğŸ‡¹',
                'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø£Ù„Ù…Ø§Ù†ÙŠ': 'ğŸ‡©ğŸ‡ª', 'Bundesliga': 'ğŸ‡©ğŸ‡ª',
                'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„ÙØ±Ù†Ø³ÙŠ': 'ğŸ‡«ğŸ‡·', 'Ligue 1': 'ğŸ‡«ğŸ‡·',
                'Ø¯ÙˆØ±ÙŠ Ø£Ø¨Ø·Ø§Ù„ Ø£ÙˆØ±ÙˆØ¨Ø§': 'ğŸ†', 'Champions League': 'ğŸ†',
                'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø£ÙˆØ±ÙˆØ¨ÙŠ': 'ğŸ¥ˆ', 'Europa League': 'ğŸ¥ˆ',
                'ÙƒØ£Ø³ Ø§Ù„Ø¹Ø§Ù„Ù…': 'ğŸŒ', 'World Cup': 'ğŸŒ',
                'Ø¯ÙˆØ±ÙŠØ§Øª Ø¹Ø±Ø¨ÙŠØ©': 'ğŸŒ™', 'Arab Leagues': 'ğŸŒ™'
            };
            return icons[league] || 'âš½';
        }

        function getLeagueFrenchName(league) {
            const frenchNames = {
                'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ Ø§Ù„Ù…Ù…ØªØ§Ø²': 'Premier League Anglaise',
                'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥Ø³Ø¨Ø§Ù†ÙŠ': 'La Liga Espagnole',
                'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥ÙŠØ·Ø§Ù„ÙŠ': 'Serie A Italienne',
                'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø£Ù„Ù…Ø§Ù†ÙŠ': 'Bundesliga Allemande',
                'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„ÙØ±Ù†Ø³ÙŠ': 'Ligue 1 FranÃ§aise',
                'Ø¯ÙˆØ±ÙŠ Ø£Ø¨Ø·Ø§Ù„ Ø£ÙˆØ±ÙˆØ¨Ø§': 'Ligue des Champions',
                'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø£ÙˆØ±ÙˆØ¨ÙŠ': 'Ligue Europa',
                'ÙƒØ£Ø³ Ø§Ù„Ø¹Ø§Ù„Ù…': 'Coupe du Monde',
                'Ø¯ÙˆØ±ÙŠØ§Øª Ø¹Ø±Ø¨ÙŠØ©': 'Ligues Arabes',
                'Ø¯ÙˆØ±ÙŠØ§Øª Ø£Ø®Ø±Ù‰': 'Autres Ligues'
            };
            return frenchNames[league] || league;
        }

        function renderMatchCard(match, isLive, isResult) {
            return `
                <div class="match-card" onclick="${isLive || (!isResult && match.streams && match.streams.length > 0) ? `openStream(${match.id})` : ''}">
                    <div class="match-league">
                        ${currentLang === 'fr' ? match.leagueFr || match.league : match.league}
                        ${match.time ? `<span class="match-time">${match.time}</span>` : ''}
                    </div>
                    <div class="match-teams">
                        <div class="team">
                            <span class="team-name">${currentLang === 'fr' ? match.homeTeamFr || match.homeTeam : match.homeTeam}</span>
                            ${match.homeScore !== undefined ? `<span class="team-score">${match.homeScore}</span>` : ''}
                        </div>
                        <div class="team">
                            <span class="team-name">${currentLang === 'fr' ? match.awayTeamFr || match.awayTeam : match.awayTeam}</span>
                            ${match.awayScore !== undefined ? `<span class="team-score">${match.awayScore}</span>` : ''}
                        </div>
                    </div>
                    <div class="match-status">${currentLang === 'fr' ? match.statusFr || match.status : match.status}</div>
                    ${!isResult && match.streams && match.streams.length > 0 ? `
                        <div class="match-actions">
                            <button class="btn btn-primary" onclick="event.stopPropagation(); openStream(${match.id})">
                                ${isLive ? getTranslation('watchLive') : getTranslation('preview')}
                            </button>
                        </div>
                    ` : ''}
                </div>
            `;
        }

        function openStream(matchId) {
            const allMatches = [...matchesData.live, ...matchesData.upcoming, ...matchesData.results];
            const match = allMatches.find(m => m.id === matchId);
            if (!match || !match.streams || match.streams.length === 0) return;

            const modal = document.getElementById('streamModal');
            const modalTitle = document.getElementById('modalTitle');
            const streamContainer = document.getElementById('streamContainer');
            const streamOptions = document.getElementById('streamOptions');

            const homeTeam = currentLang === 'fr' ? match.homeTeamFr || match.homeTeam : match.homeTeam;
            const awayTeam = currentLang === 'fr' ? match.awayTeamFr || match.awayTeam : match.awayTeam;
            modalTitle.textContent = `${homeTeam} ${getTranslation('vs')} ${awayTeam}`;
            
            streamOptions.innerHTML = match.streams.map((stream, index) => `
                <button class="stream-btn ${index === 0 ? 'active' : ''}" onclick="loadStream('${stream.url}', this)">
                    ${currentLang === 'fr' ? stream.nameFr || stream.name : stream.name}
                </button>
            `).join('');

            streamContainer.innerHTML = `<div style="color: var(--color-white);">${getTranslation('note')}</div>`;
            modal.classList.add('active');
        }

        function loadStream(url, button) {
            const streamContainer = document.getElementById('streamContainer');
            const allBtns = document.querySelectorAll('.stream-btn');
            allBtns.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
            streamContainer.innerHTML = `<iframe src="${url}" allowfullscreen></iframe>`;
        }

        function closeModal() {
            const modal = document.getElementById('streamModal');
            modal.classList.remove('active');
            const streamContainer = document.getElementById('streamContainer');
            streamContainer.innerHTML = `<div id="streamPlaceholder">${getTranslation('selectStream')}</div>`;
        }

        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentSport = btn.dataset.sport;
                renderMatches();
            });
        });

        document.getElementById('streamModal').addEventListener('click', (e) => {
            if (e.target.id === 'streamModal') closeModal();
        });

        async function fetchFromCamelLive() {
            if (isLoading) return null;
            isLoading = true;
            try {
                console.log('ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Camel Live...');
                for (let attempt = 0; attempt < API_CONFIG.retryAttempts; attempt++) {
                    for (let i = 0; i < API_CONFIG.corsProxies.length; i++) {
                        try {
                            const proxy = API_CONFIG.corsProxies[currentProxyIndex];
                            const url = proxy + encodeURIComponent(API_CONFIG.camelLiveUrl);
                            console.log(`Ù…Ø­Ø§ÙˆÙ„Ø© ${attempt + 1}.${i + 1}: ${proxy.split('//')[1].split('/')[0]}`);
                            const controller = new AbortController();
                            const timeoutId = setTimeout(() => controller.abort(), API_CONFIG.timeout);
                            const response = await fetch(url, {
                                method: 'GET',
                                signal: controller.signal,
                                headers: {
                                    'Accept': 'text/html,application/xhtml+xml',
                                    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',
                                    'Cache-Control': 'no-cache'
                                }
                            });
                            clearTimeout(timeoutId);
                            if (response.ok) {
                                const html = await response.text();
                                if (html.length < 100) {
                                    console.warn('âš ï¸ Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù‚ØµÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹');
                                    continue;
                                }
                                const parser = new DOMParser();
                                const doc = parser.parseFromString(html, 'text/html');
                                const data = parseMatchesFromHTML(doc);
                                if (data && (data.live.length > 0 || data.upcoming.length > 0)) {
                                    console.log('âœ… ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù†Ø¬Ø§Ø­!');
                                    console.log(`ğŸ“Š Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ${data.live.length} Ù…Ø¨Ø§Ø´Ø±, ${data.upcoming.length} Ù‚Ø§Ø¯Ù…Ø©, ${data.results.length} Ù†ØªØ§Ø¦Ø¬`);
                                    lastFetchTime = new Date();
                                    localStorage.setItem('lastSuccessfulProxy', currentProxyIndex.toString());
                                    return data;
                                }
                            }
                            currentProxyIndex = (currentProxyIndex + 1) % API_CONFIG.corsProxies.length;
                        } catch (err) {
                            console.warn(`ÙØ´Ù„ Proxy ${i + 1}:`, err.message);
                            currentProxyIndex = (currentProxyIndex + 1) % API_CONFIG.corsProxies.length;
                            if (i < API_CONFIG.corsProxies.length - 1) {
                                await new Promise(resolve => setTimeout(resolve, 500));
                            }
                            continue;
                        }
                    }
                    if (attempt < API_CONFIG.retryAttempts - 1) {
                        console.log('â³ Ø§Ù†ØªØ¸Ø§Ø± Ù‚Ø¨Ù„ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©...');
                        await new Promise(resolve => setTimeout(resolve, 2000));
                    }
                }
                throw new Error('ÙØ´Ù„Øª Ø¬Ù…ÙŠØ¹ Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„');
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£:', error.message);
                console.log('ğŸ“Š Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©');
                return generateDemoData();
            } finally {
                isLoading = false;
            }
        }
        
        function generateDemoData() {
            console.log('ğŸ“Š Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©');
            return {
                live: [
                    {
                        id: 1, league: 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ Ø§Ù„Ù…Ù…ØªØ§Ø²', leagueFr: 'Premier League Anglaise', sport: 'football',
                        homeTeam: 'Ù…Ø§Ù†Ø´Ø³ØªØ± Ø³ÙŠØªÙŠ', homeTeamFr: 'Manchester City', awayTeam: 'Ù„ÙŠÙØ±Ø¨ÙˆÙ„', awayTeamFr: 'Liverpool',
                        homeScore: 2, awayScore: 1, time: '67\'', status: 'Ø§Ù„Ø´ÙˆØ· Ø§Ù„Ø«Ø§Ù†ÙŠ', statusFr: 'DeuxiÃ¨me Mi-Temps',
                        streams: [
                            { name: 'Ø¨Ø« HD', nameFr: 'Stream HD', url: 'https://www.camel1.live/live/match1' },
                            { name: 'Ø¨Ø« Ø¨Ø¯ÙŠÙ„', nameFr: 'Stream Alternatif', url: 'https://www.camel1.live/stream/match1' },
                            { name: 'Ø¨Ø« Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ©', nameFr: 'Stream HQ', url: 'https://www.camel1.live/hd/match1' }
                        ]
                    },
                    {
                        id: 2, league: 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥Ø³Ø¨Ø§Ù†ÙŠ', leagueFr: 'La Liga Espagnole', sport: 'football',
                        homeTeam: 'Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯', homeTeamFr: 'Real Madrid', awayTeam: 'Ø¨Ø±Ø´Ù„ÙˆÙ†Ø©', awayTeamFr: 'FC Barcelone',
                        homeScore: 1, awayScore: 1, time: '34\'', status: 'Ø§Ù„Ø´ÙˆØ· Ø§Ù„Ø£ÙˆÙ„', statusFr: 'PremiÃ¨re Mi-Temps',
                        streams: [
                            { name: 'Ø¨Ø« 1', nameFr: 'Stream 1', url: 'https://www.camel1.live/live/match2' },
                            { name: 'Ø¨Ø« 2', nameFr: 'Stream 2', url: 'https://www.camel1.live/stream/match2' }
                        ]
                    }
                ],
                upcoming: [
                    {
                        id: 3, league: 'Ø¯ÙˆØ±ÙŠ Ø£Ø¨Ø·Ø§Ù„ Ø£ÙˆØ±ÙˆØ¨Ø§', leagueFr: 'Ligue des Champions', sport: 'football',
                        homeTeam: 'Ø¨Ø§ÙŠØ±Ù† Ù…ÙŠÙˆÙ†Ø®', homeTeamFr: 'Bayern Munich', awayTeam: 'Ø¨Ø§Ø±ÙŠØ³ Ø³Ø§Ù† Ø¬ÙŠØ±Ù…Ø§Ù†', awayTeamFr: 'Paris Saint-Germain',
                        time: '21:00', status: 'Ù„Ù… ØªØ¨Ø¯Ø£ Ø¨Ø¹Ø¯', statusFr: 'Pas encore commencÃ©',
                        streams: [
                            { name: 'Ø¨Ø« 1', nameFr: 'Stream 1', url: 'https://www.camel1.live/live/match3' },
                            { name: 'Ø¨Ø« 2', nameFr: 'Stream 2', url: 'https://www.camel1.live/stream/match3' }
                        ]
                    },
                    {
                        id: 4, league: 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥ÙŠØ·Ø§Ù„ÙŠ', leagueFr: 'Serie A Italienne', sport: 'football',
                        homeTeam: 'ÙŠÙˆÙÙ†ØªÙˆØ³', homeTeamFr: 'Juventus', awayTeam: 'Ø¥Ù†ØªØ± Ù…ÙŠÙ„Ø§Ù†', awayTeamFr: 'Inter Milan',
                        time: '20:45', status: 'Ù‚Ø±ÙŠØ¨Ø§Ù‹', statusFr: 'BientÃ´t',
                        streams: [{ name: 'Ø¨Ø« Ù…Ø¨Ø§Ø´Ø±', nameFr: 'Stream Live', url: 'https://www.camel1.live/live/match4' }]
                    }
                ],
                results: [
                    {
                        id: 5, league: 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø£Ù„Ù…Ø§Ù†ÙŠ', leagueFr: 'Bundesliga Allemande', sport: 'football',
                        homeTeam: 'Ø¯ÙˆØ±ØªÙ…ÙˆÙ†Ø¯', homeTeamFr: 'Borussia Dortmund', awayTeam: 'Ø¨Ø§ÙŠØ±Ù† Ù…ÙŠÙˆÙ†Ø®', awayTeamFr: 'Bayern Munich',
                        homeScore: 2, awayScore: 3, status: 'Ø§Ù†ØªÙ‡Øª', statusFr: 'TerminÃ©', streams: []
                    }
                ]
            };
        }

        function parseMatchesFromHTML(doc) {
            const live = [], upcoming = [], results = [];
            try {
                const possibleSelectors = ['article', '.card', '.item', '.box', '[class*="match"]', '[class*="game"]', '[class*="fixture"]', '[class*="event"]', '[data-match]', '[data-game]'];
                let matchElements = [];
                for (const selector of possibleSelectors) {
                    const elements = doc.querySelectorAll(selector);
                    if (elements.length > 2) {
                        matchElements = elements;
                        console.log(`âœ… Ø¹Ø«Ø± Ø¹Ù„Ù‰ ${elements.length} Ø¹Ù†Ø§ØµØ±: ${selector}`);
                        break;
                    }
                }
                if (matchElements.length === 0) {
                    console.warn('âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ø¨Ø§Ø±ÙŠØ§Øª');
                    return null;
                }
                let validMatches = 0;
                matchElements.forEach((element, index) => {
                    try {
                        const match = extractMatchData(element, index);
                        if (match && match.homeTeam && match.awayTeam) {
                            validMatches++;
                            if (match.isLive) live.push(match);
                            else if (match.isFinished) results.push(match);
                            else upcoming.push(match);
                        }
                    } catch (err) {}
                });
                console.log(`ğŸ“Š Ù…Ø¨Ø§Ø±ÙŠØ§Øª ØµØ§Ù„Ø­Ø©: ${validMatches} (${live.length} Ù…Ø¨Ø§Ø´Ø±, ${upcoming.length} Ù‚Ø§Ø¯Ù…Ø©, ${results.length} Ù†ØªØ§Ø¦Ø¬)`);
                if (validMatches === 0) return null;
                return { live, upcoming, results };
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„:', error);
                return null;
            }
        }

        function extractMatchData(element, index) {
            const match = { id: Date.now() + index, sport: 'football', streams: [] };
            const text = element.textContent;
            const teamSelectors = ['h3', 'h4', 'h5', '.team', '[class*="team"]', '.name', 'strong', 'b', 'span'];
            const teams = [];
            for (const selector of teamSelectors) {
                const elements = element.querySelectorAll(selector);
                if (elements.length >= 2) {
                    const team1 = elements[0].textContent.trim();
                    const team2 = elements[1].textContent.trim();
                    if (team1.length > 2 && team2.length > 2 && team1 !== team2) {
                        teams.push(team1, team2);
                        break;
                    }
                }
            }
            if (teams.length < 2) {
                const vsMatch = text.match(/([^0-9\n]{3,30})\s*(?:vs|Ø¶Ø¯|-)\s*([^0-9\n]{3,30})/i);
                if (vsMatch) teams.push(vsMatch[1].trim(), vsMatch[2].trim());
            }
            match.homeTeam = teams[0] || null;
            match.awayTeam = teams[1] || null;
            if (!match.homeTeam || !match.awayTeam) return null;
            const scoreMatch = text.match(/(\d+)\s*[-:]\s*(\d+)/);
            if (scoreMatch) {
                match.homeScore = parseInt(scoreMatch[1]);
                match.awayScore = parseInt(scoreMatch[2]);
            }
            const timeMatch = text.match(/(\d{1,2}:\d{2}|Ø§Ù„Ø¢Ù†|live|\d+')/i);
            if (timeMatch) match.time = timeMatch[0];
            const leagueSelectors = ['.league', '.tournament', '.competition', '[class*="league"]', '[class*="tournament"]', 'small', '.subtitle'];
            for (const selector of leagueSelectors) {
                const el = element.querySelector(selector);
                if (el && el.textContent.trim().length > 3) {
                    match.league = el.textContent.trim();
                    break;
                }
            }
            if (!match.league) {
                const leagueMatch = text.match(/(Ø¯ÙˆØ±ÙŠ|ÙƒØ£Ø³|Ø¨Ø·ÙˆÙ„Ø©|league|cup|champions)[^0-9\n]{3,40}/i);
                if (leagueMatch) match.league = leagueMatch[0].trim().substring(0, 40);
            }
            match.league = match.league || (currentLang === 'fr' ? 'Match Amical' : 'Ù…Ø¨Ø§Ø±Ø§Ø© ÙˆØ¯ÙŠØ©');
            match.league = normalizeLeagueName(match.league);
            const lowerText = text.toLowerCase();
            match.isLive = lowerText.includes('live') || lowerText.includes('Ù…Ø¨Ø§Ø´Ø±') || lowerText.includes('Ø¨Ø«') || match.homeScore !== undefined;
            match.isFinished = lowerText.includes('Ø§Ù†ØªÙ‡Øª') || lowerText.includes('finished') || lowerText.includes('ft') || lowerText.includes('Ù†Ù‡Ø§ÙŠØ©');
            match.status = match.isLive ? 'Ù…Ø¨Ø§Ø´Ø± Ø§Ù„Ø¢Ù†' : match.isFinished ? 'Ø§Ù†ØªÙ‡Øª' : 'Ù‚Ø±ÙŠØ¨Ø§Ù‹';
            const links = element.querySelectorAll('a[href]');
            links.forEach((link, i) => {
                const href = link.getAttribute('href');
                if (href && !href.startsWith('#') && !href.includes('javascript')) {
                    const fullUrl = href.startsWith('http') ? href : API_CONFIG.camelLiveUrl + href.replace(/^\//, '');
                    match.streams.push({ name: link.textContent.trim() || `Ø¨Ø« ${i + 1}`, url: fullUrl });
                }
            });
            if (match.streams.length === 0 && (match.isLive || !match.isFinished)) {
                match.streams.push(
                    { name: 'Ø¨Ø« Ù…Ø¨Ø§Ø´Ø±', url: `${API_CONFIG.camelLiveUrl}live/${match.id}` },
                    { name: 'Ø¨Ø« Ø¨Ø¯ÙŠÙ„', url: `${API_CONFIG.camelLiveUrl}stream/${match.id}` }
                );
            }
            return match;
        }

        function normalizeLeagueName(league) {
            const leagueMap = {
                'premier league': 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ Ø§Ù„Ù…Ù…ØªØ§Ø²', 'epl': 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ Ø§Ù„Ù…Ù…ØªØ§Ø²', 'english premier': 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ Ø§Ù„Ù…Ù…ØªØ§Ø²',
                'la liga': 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥Ø³Ø¨Ø§Ù†ÙŠ', 'spanish league': 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥Ø³Ø¨Ø§Ù†ÙŠ', 'liga': 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥Ø³Ø¨Ø§Ù†ÙŠ',
                'serie a': 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥ÙŠØ·Ø§Ù„ÙŠ', 'italian league': 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥ÙŠØ·Ø§Ù„ÙŠ', 'calcio': 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥ÙŠØ·Ø§Ù„ÙŠ',
                'bundesliga': 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø£Ù„Ù…Ø§Ù†ÙŠ', 'german league': 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø£Ù„Ù…Ø§Ù†ÙŠ',
                'ligue 1': 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„ÙØ±Ù†Ø³ÙŠ', 'french league': 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„ÙØ±Ù†Ø³ÙŠ',
                'champions league': 'Ø¯ÙˆØ±ÙŠ Ø£Ø¨Ø·Ø§Ù„ Ø£ÙˆØ±ÙˆØ¨Ø§', 'ucl': 'Ø¯ÙˆØ±ÙŠ Ø£Ø¨Ø·Ø§Ù„ Ø£ÙˆØ±ÙˆØ¨Ø§', 'uefa champions': 'Ø¯ÙˆØ±ÙŠ Ø£Ø¨Ø·Ø§Ù„ Ø£ÙˆØ±ÙˆØ¨Ø§',
                'europa league': 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø£ÙˆØ±ÙˆØ¨ÙŠ', 'uel': 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø£ÙˆØ±ÙˆØ¨ÙŠ',
                'world cup': 'ÙƒØ£Ø³ Ø§Ù„Ø¹Ø§Ù„Ù…', 'fifa world cup': 'ÙƒØ£Ø³ Ø§Ù„Ø¹Ø§Ù„Ù…',
                'saudi league': 'Ø¯ÙˆØ±ÙŠØ§Øª Ø¹Ø±Ø¨ÙŠØ©', 'egyptian league': 'Ø¯ÙˆØ±ÙŠØ§Øª Ø¹Ø±Ø¨ÙŠØ©',
                'Ù‚Ø·Ø±': 'Ø¯ÙˆØ±ÙŠØ§Øª Ø¹Ø±Ø¨ÙŠØ©', 'Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª': 'Ø¯ÙˆØ±ÙŠØ§Øª Ø¹Ø±Ø¨ÙŠØ©', 'Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©': 'Ø¯ÙˆØ±ÙŠØ§Øª Ø¹Ø±Ø¨ÙŠØ©', 'Ù…ØµØ±': 'Ø¯ÙˆØ±ÙŠØ§Øª Ø¹Ø±Ø¨ÙŠØ©'
            };
            const lowerLeague = league.toLowerCase();
            for (const [key, value] of Object.entries(leagueMap)) {
                if (lowerLeague.includes(key)) return value;
            }
            return league;
        }

        async function updateMatches() {
            if (isLoading) {
                console.log('â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ«...');
                return;
            }
            console.log('ğŸ”„ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠØ«...');
            const data = await fetchFromCamelLive();
            if (data && (data.live.length > 0 || data.upcoming.length > 0)) {
                matchesData = data;
                console.log(`âœ… Ù†Ø¬Ø­: ${data.live.length} Ù…Ø¨Ø§Ø´Ø±, ${data.upcoming.length} Ù‚Ø§Ø¯Ù…Ø©`);
            } else {
                console.log('ğŸ“Š Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©');
                matchesData = generateDemoData();
            }
            renderMatches();
        }

        (async function init() {
            console.log('ğŸš€ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆÙ‚Ø¹...');
            console.log('ğŸ“ Ø§Ù„Ø¨ÙŠØ¦Ø©: GitHub + Vercel');
            currentLang = localStorage.getItem('language') || 'ar';
            document.documentElement.setAttribute('lang', currentLang);
            document.documentElement.setAttribute('dir', currentLang === 'ar' ? 'rtl' : 'ltr');
            updateUILanguage();
            const savedProxy = localStorage.getItem('lastSuccessfulProxy');
            if (savedProxy) {
                currentProxyIndex = parseInt(savedProxy);
                console.log('â™»ï¸ Ø§Ø³ØªØ®Ø¯Ø§Ù… Proxy Ø§Ù„Ù†Ø§Ø¬Ø­ Ø§Ù„Ø³Ø§Ø¨Ù‚');
            }
            matchesData = generateDemoData();
            renderMatches();
            setTimeout(() => { updateMatches(); }, 1000);
        })();

        setInterval(updateMatches, API_CONFIG.updateInterval);
        document.addEventListener('visibilitychange', () => {
            if (!document.hidden && lastFetchTime) {
                const elapsed = new Date() - lastFetchTime;
                if (elapsed > API_CONFIG.updateInterval) {
                    console.log('ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø¨Ø¹Ø¯ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø©');
                    updateMatches();
                }
            }
        });
        window.addEventListener('error', (e) => { console.error('âš ï¸ Ø®Ø·Ø£ Ø¹Ø§Ù…:', e.message); });
        window.addEventListener('beforeunload', () => {
            if (matchesData && matchesData.live.length > 0) {
                try {
                    localStorage.setItem('cachedMatches', JSON.stringify({ data: matchesData, timestamp: Date.now() }));
                } catch (e) { console.warn('ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¤Ù‚ØªØ©'); }
            }
        });
    </script>
</body>
</html>
